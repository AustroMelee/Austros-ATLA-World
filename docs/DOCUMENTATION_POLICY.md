# Documentation Policy & Automation

This document details the policies and automated processes for creating and maintaining accurate, up-to-date system documentation.

## Document Conventions
- **Headings:** All major sections use ##, subsections use ###.
- **Code/Commands:** Use markdown code blocks for all commands and code snippets.
- **Terminology:** See the Glossary of Terms for all domain-specific and architectural terms.

## Documentation: Policy & Automation
### Documentation Update Policy (Critical)
> **Best Practice & Policy:** Whenever a file's implementation, responsibility, or integration changes (including refactors, logging, or SRP updates), the corresponding file description, tags, and criticality in project documentation MUST be updated in the same batch. This ensures the documentation always reflects the true state of the codebase and prevents architectural drift.

### Automation & Self-Updating Architecture
- **Structured Comments:** Critical files should contain structured comments:
```typescript
// @docs
// @description: The heart of the battle engine...
// @criticality: ðŸ©¸ High Risk
// @owner: AustroMelee
// @tags: core-logic, turn
```
- **Refresh Script:** A script (npm run docs:refresh) scans the codebase for @docs tags and automatically regenerates tables and file indexes.
- **Code-Level Cross-Referencing:** The script also parses imports/exports to generate "Used By" and "Calls" lists, providing a live map of dependencies.
- **Result:** Zero drift between code and documentation and frictionless, accurate updates.

### Legendary File Index Automation (ALL_FILES_INDEX.md)
- **Canonical File Map:** docs/ALL_FILES_INDEX.md is the single source of truth for all files in the codebase. It is always up-to-date, generated by automation, and must never be hand-edited.
- **Automation Script:** The file is generated by scripts/auto-crossref.cjs (run via node scripts/auto-crossref.cjs or as part of npm run docs:refresh).
- **Columns:** The script generates a comprehensive table with columns for Path, Description, Category, Tags, Status, Last Modified, and Owner.
- **Orphaned/Dead Code Detection:** The script analyzes the import graph to flag files not imported anywhere.
- **CI/Pre-commit Enforcement:** The index must be updated in every commit that adds, removes, or modifies files. This is enforced by pre-commit/CI hooks.
- **Reference:** For the full, always-up-to-date file listing, see docs/ALL_FILES_INDEX.md. For script details, see scripts/auto-crossref.cjs.
